{"version":3,"file":"index.js","sources":["../src/main.js"],"sourcesContent":["import axios from 'axios';\r\nimport SimpleLightbox from 'simplelightbox';\r\nimport 'simplelightbox/dist/simple-lightbox.min.css';\r\nimport 'iziToast/dist/css/iziToast.min.css';\r\nimport iziToast from 'izitoast';\r\n\r\nclass ImageGallery {\r\n  constructor(searchInput, searchButton, gallery, loadingSpinner, loadMoreButton) {\r\n    this.searchInput = searchInput;\r\n    this.searchButton = searchButton;\r\n    this.gallery = gallery;\r\n    this.loadingSpinner = loadingSpinner;\r\n    this.loadMoreButton = loadMoreButton;\r\n    this.currentPage = 1;\r\n    this.currentQuery = '';\r\n    this.lightbox = new SimpleLightbox('.gallery a', {\r\n      captions: true,\r\n      captionsData: 'alt',\r\n      captionDelay: 250\r\n    });\r\n\r\n    this.initialize();\r\n  }\r\n\r\n  initialize() {\r\n    this.loadMoreButton.classList.add('hidden')\r\n\r\n    this.searchButton.addEventListener('click', this.handleSearch.bind(this));\r\n    this.loadMoreButton.addEventListener('click', this.loadMoreImages.bind(this));\r\n  }\r\n\r\n  async handleSearch() {\r\n    this.currentQuery = this.searchInput.value;\r\n    this.currentPage = 1;\r\n    this.gallery.innerHTML = ''; \r\n    await this.fetchImages(); \r\n  }\r\n\r\n  async loadMoreImages() {\r\n    this.currentPage++; \r\n\r\n    await this.fetchImages(); \r\n    this.scrollGallery();\r\n  }\r\n  scrollGallery() {\r\n    const galleryItems = this.gallery.querySelectorAll('.gallery-item');\r\n    if (galleryItems.length > 1) {\r\n      const itemHeight = galleryItems[0].getBoundingClientRect().height;\r\n      window.scrollBy({ top: itemHeight * 2, behavior: 'smooth' });\r\n    }\r\n  }\r\n  async fetchImages() {\r\n    const url = `${import.meta.env.VITE_API_URL}/?key=${import.meta.env.VITE_API_KEY}&q=${this.currentQuery}&image_type=photo&orientation=horizontal&safesearch=true&page=${this.currentPage}&page_per=40`;\r\n\r\n    this.loadingSpinner.classList.remove('hidden');\r\n    this.loadMoreButton.classList.remove('hidden')\r\n    try {\r\n      const response = await axios.get(url);\r\n      const data = response.data;\r\n      console.log(data)\r\n      const galleryItems = data.hits\r\n      .map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => {\r\n        return `\r\n          <li class=\"gallery-item\">\r\n            <a href=\"${largeImageURL}\" data-lightbox=\"gallery\" data-title=\"${tags}\">\r\n              <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\"/>\r\n            </a>\r\n            <div class=\"bottom-item\">\r\n              <div class=\"bottom-item-div\"><p class=\"bottom-item-p1\">Likes</p><p class=\"bottom-item-p2\">${likes}</p></div>\r\n              <div class=\"bottom-item-div\"><p class=\"bottom-item-p1\">Views</p><p class=\"bottom-item-p2\">${views}</p></div>\r\n              <div class=\"bottom-item-div\"><p class=\"bottom-item-p1\">Comments</p><p class=\"bottom-item-p2\">${comments}</p></div>\r\n              <div class=\"bottom-item-div\"><p class=\"bottom-item-p1\">Downloads</p><p class=\"bottom-item-p2\">${downloads}</p></div>\r\n            </div>\r\n          </li>\r\n        `;\r\n      })\r\n      .join(\"\");\r\n      this.gallery.innerHTML += galleryItems;\r\n\r\n     \r\n      if (data.hits.length===0) {\r\n        iziToast.info({\r\n          title: 'Info',\r\n          message: 'Sorry, there are no images matching your search query. Please try again!',\r\n          position: 'topRight',\r\n          backgroundColor: 'red',\r\n        });\r\n        this.loadingSpinner.classList.add('hidden');\r\n        this.loadMoreButton.classList.add('hidden')\r\n        return;\r\n      }\r\nconsole.log(data.totalHits-(this.currentPage*40))\r\n\r\n      if (data.totalHits-(this.currentPage*40) < 40 && this.currentPage >= 1) {\r\n        this.loadMoreButton.classList.add('hidden'); \r\n        this.loadingSpinner.classList.add('hidden');\r\n\r\n        iziToast.info({\r\n          title: 'Info',\r\n          message: `We're sorry, but you've reached the end of search results`,\r\n          position: 'topRight',\r\n          backgroundColor: 'yellow',\r\n        });\r\n        return;\r\n      }\r\n\r\n\r\n      this.loadMoreButton.classList.remove()\r\n      this.lightbox.refresh(); \r\n    } catch (error) {\r\n      console.error('Hata:', error);\r\n    } finally {\r\n      this.loadingSpinner.classList.add('hidden'); \r\n    }\r\n  }\r\n}\r\n\r\nconst searchInput = document.getElementById('search-input');\r\nconst searchButton = document.getElementById('search-button');\r\nconst gallery = document.getElementById('gallery');\r\nconst loadingSpinner = document.getElementById('loading-spinner');\r\nconst loadMoreButton = document.getElementById('load-more-button');\r\n\r\nconst imageGallery = new ImageGallery(searchInput, searchButton, gallery, loadingSpinner, loadMoreButton);\r\n"],"names":["ImageGallery","searchInput","searchButton","gallery","loadingSpinner","loadMoreButton","SimpleLightbox","galleryItems","itemHeight","url","data","axios","webformatURL","largeImageURL","tags","likes","views","comments","downloads","iziToast","error"],"mappings":"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"}